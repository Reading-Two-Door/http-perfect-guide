## 공부 내용

- 서버는 내용 협상을 통해 하나의 URL이 여러 가지 리소스 중 적합한 버전(variant)에 대응되도록 할 수 있다.

### 내용 협상 기법

#### 클라이언트 주도 협상

- 서버에게 가장 쉬운 방법은 가능한 페이지의 목록을 응답으로 돌려주고 클라이언트가 선택하게 하는 것이다.
- 단점은 두 번의 요청이 필요하고 여러 개의 url을 필요로 한다는 점이다.
- 기술적으로, 서버는 선택지를 표현하는 두 가지 방법이 있다.
  - 여러 가지 버전에 대한 링크와 각 각에 대한 설명이 담긴 HTML 페이지를 돌려주는 방법
  - 300 응답 코드로 HTTP/1.1 응답을 돌려주는 방법

#### 서버 주도 협상

- 서버가 어떤 페이지를 돌려줄 것인지 결정하는 것으로 클라이언트가 반드시 무엇을 선호하는지에 대한 충분한 정보를 주어야 한다.
- Accept 관련 헤더들을 보고 알맞은 응답을 준비한다. User-Agent 헤더에 기반하여 응답을 보내줄 수도 있다.

#### 내용 협상 헤더

| 헤더            | 설명                                                |
| --------------- | --------------------------------------------------- |
| Accept          | 서버가 어떤 미디어 타입으로 보내도 되는지 알려준다. |
| Accept-Language | 서버가 어떤 언어로 보내도 되는지 알려준다.          |
| Accept-Charset  | 서버가 어떤 차셋으로 보내도 되는지 알려준다.        |
| Accept-Encoding | 서버가 어떤 인코딩으로 보내도 되는지 알려준다.      |

- 엔터티 헤더와 유사하지만 엔터티 헤더는 메시지 본문의 속성을 가리키고, 내용 협상 헤더들은 클라이언트와 서버ㅇ가 선호 정보로 교환하여 클라이언트의 선호에 가장 잚 맞는 문서를 제공해 주기 위한 목적으로 사용된다.
- HTTP는 상태가 없는 프로토콜이기 때문에, 클라이언트는 자신의 선호 정보를 반드시 매 요청마다 보내야 한다.

- q값을 사용하여 선호도를 나열 할 수 있다.
- 캐시는 반드시 캐시된 문서의 올바른 최선의 버전을 제공해주려 해야 하기 때문에, HTTP 프로토콜은 서버가 응답에 넣어 보낼 수 있는 Vary 헤더를 정의한다.
  - Vary 헤더 - 캐시에게 서버가 내줄 응답의 최선의 버전을 결정하기 위해 어떤 요청 헤더를 참고하고 있는지 말해준다.
- 서버 측 확장을 통해 내용 협상을 구현할 수도 있다.

### 투명 협상

- 클라이언트 입장에서 협상하는 중개자 프락시를 둠으로써 클라이언트와의 메시지 교환을 최소화하는 동시에 서버 주도 협상으로 인한 부하를 서버에서 제거한다. 프락시는 클라이언트의 기대가 무엇인지 알고 있고, 클라이언트의 입장에서 협상을 수행할 수 있는 능력이 있는 것으로 가정된다.

#### 캐시와 얼터네이트

- 캐시하는 것은 재사용을 예상하기 때문이고 올바른 캐시 응답을 위해서는, 응답을 돌려줄 때 사용했던 의사결정 로직의 상당 부분을 그대로 사용해야 한다.
- 캐시가 가지는 다른 버전을 variant나 alternate라고 한다.

#### Vary 헤더

- 서버가 문서를 선택하거나 커스텀 콘텐츠를 생성할 때 고려한 클라이언트 요청 헤더 모두를 나열한다.
- 캐시된 응답 안에 Vary 헤더가 있다면 새 요청과 오래된 캐시된 요청에서 그 값이 서로 동일해야한다.

### 트랜스코딩

- 서버가 클라이언트의 요구에 맞는 문서를 아예 가지고 있지 않는 경우 기존의 문서를 변환하여 사용할 수 있다. 이것이 트랜스코딩이다.

#### 포맷 변환

- 포맷 변환은 데이터를 클라이언트가 볼 수 있도록 한 포맷에서 다른 포맷으로 변환하는 것이다.
- 포맷 변환은 내용 협상 헤더에 의해 주도된다.
- 콘텐츠를 특정 접근 장치에서 볼 수 있도록 하기 위함

#### 정보 합성

- 문서에서 정보의 요점을 추출하는 것
- 본문의 키워드에 기반하여 페이지를 분류

#### 콘텐츠 주입

- 특정 사용자를 대상으로 동적으로 이루어진다.
- 광고 삽입, 웹 통계 수집 등

#### 트랜스코딩 vs 정적으로 미리 생성

- 트랜스코딩의 대안은 여러 사본을 미리 생성하는 것이다.

## 알게된 점

## 궁금한 점
